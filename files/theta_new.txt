I did some changes to theta in theta branch.